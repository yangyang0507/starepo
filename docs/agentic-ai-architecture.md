# Starepo Agentic AI æ¶æ„è®¾è®¡æ–‡æ¡£

## æ ¸å¿ƒç†å¿µ

**ä¸æ˜¯åŸºäºå‘é‡æœç´¢ï¼Œè€Œæ˜¯åŸºäº AI Agent + å·¥å…·é“¾çš„æ™ºèƒ½ç³»ç»Ÿ**

ä¼ ç»Ÿçš„å‘é‡æœç´¢æ–¹æ¡ˆéœ€è¦ï¼š

- âŒ ç”Ÿæˆå’Œå­˜å‚¨ Embeddingsï¼ˆè®¡ç®—æˆæœ¬é«˜ï¼‰
- âŒ ç»´æŠ¤å‘é‡æ•°æ®åº“ï¼ˆLanceDB/ChromaDBï¼‰
- âŒ å¤æ‚çš„ç›¸ä¼¼åº¦è®¡ç®—å’Œç´¢å¼•ç®¡ç†
- âŒ å‘é‡è´¨é‡ä¾èµ– Embedding æ¨¡å‹

**Agentic AI æ–¹æ¡ˆ**ï¼š

- âœ… AI Agent è‡ªä¸»ç†è§£ç”¨æˆ·æ„å›¾
- âœ… åŠ¨æ€é€‰æ‹©å’Œç»„åˆå·¥å…·å®Œæˆä»»åŠ¡
- âœ… ç®€å•é«˜æ•ˆçš„æœ¬åœ°æ•°æ®å­˜å‚¨ï¼ˆJSON/SQLiteï¼‰
- âœ… é€æ˜å¯è§£é‡Šçš„æœç´¢è¿‡ç¨‹

---

## ç³»ç»Ÿæ¶æ„

### 1. æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          èŠå¤©ç•Œé¢ (Chat Interface)                     â”‚  â”‚
â”‚  â”‚  â€¢ è‡ªç„¶è¯­è¨€è¾“å…¥                                        â”‚  â”‚
â”‚  â”‚  â€¢ æµå¼å“åº”å±•ç¤º                                        â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·è°ƒç”¨å¯è§†åŒ–                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AI Agent å±‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           AI Agent (AI SDK V5)                        â”‚  â”‚
â”‚  â”‚  â€¢ æ„å›¾ç†è§£                                            â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·é€‰æ‹©                                            â”‚  â”‚
â”‚  â”‚  â€¢ ç»“æœæ•´åˆ                                            â”‚  â”‚
â”‚  â”‚  â€¢ è‡ªç„¶è¯­è¨€ç”Ÿæˆ                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       å·¥å…·æ³¨å†Œè¡¨å±‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        Tool Registry (å·¥å…·æ³¨å†Œè¡¨)                      â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·å®šä¹‰å’Œæ³¨å†Œ                                      â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·å‚æ•°éªŒè¯ (Zod Schema)                          â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·è°ƒç”¨åˆ†å‘                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å·¥å…·å®ç°å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æœç´¢å·¥å…·é›†    â”‚  â”‚  åˆ†æå·¥å…·é›†    â”‚  â”‚ GitHubå·¥å…·é›†  â”‚  â”‚
â”‚  â”‚                â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚ â€¢ searchBy     â”‚  â”‚ â€¢ analyze      â”‚  â”‚ â€¢ getRepo     â”‚  â”‚
â”‚  â”‚   Keyword      â”‚  â”‚   Language     â”‚  â”‚   Details     â”‚  â”‚
â”‚  â”‚ â€¢ filterBy     â”‚  â”‚   Distribution â”‚  â”‚ â€¢ star/       â”‚  â”‚
â”‚  â”‚   Language     â”‚  â”‚ â€¢ findTrending â”‚  â”‚   unstar      â”‚  â”‚
â”‚  â”‚ â€¢ filterBy     â”‚  â”‚   Repos        â”‚  â”‚ â€¢ syncStars   â”‚  â”‚
â”‚  â”‚   Stars        â”‚  â”‚ â€¢ compareRepos â”‚  â”‚               â”‚  â”‚
â”‚  â”‚ â€¢ filterBy     â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚   Date         â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚ â€¢ searchBy     â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚   Topic        â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚ â€¢ searchIn     â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â”‚   Readme       â”‚  â”‚                â”‚  â”‚               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ•°æ®å­˜å‚¨å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  æœ¬åœ°æ•°æ®åº“       â”‚          â”‚  GitHub API      â”‚        â”‚
â”‚  â”‚  (JSON/SQLite)   â”‚          â”‚  (Octokit.js)    â”‚        â”‚
â”‚  â”‚                  â”‚          â”‚                  â”‚        â”‚
â”‚  â”‚ â€¢ Repositories   â”‚          â”‚ â€¢ Fetch Stars    â”‚        â”‚
â”‚  â”‚ â€¢ User Info      â”‚          â”‚ â€¢ Repo Details   â”‚        â”‚
â”‚  â”‚ â€¢ Metadata       â”‚          â”‚ â€¢ Rate Limits    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 2.1 AI Agent æ ¸å¿ƒ (`src/main/services/ai/agent.ts`)

**èŒè´£ï¼š**

- æ¥æ”¶ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢
- ç†è§£ç”¨æˆ·æ„å›¾
- å†³å®šè°ƒç”¨å“ªäº›å·¥å…·ï¼ˆTool Callingï¼‰
- æ•´åˆå·¥å…·è¿”å›çš„ç»“æœ
- ç”Ÿæˆè‡ªç„¶è¯­è¨€å›å¤

**å®ç°è¦ç‚¹ï¼š**

```typescript
import { generateText, streamText, tool } from "ai";

export class AIAgent {
  private model: LanguageModel;
  private tools: Map<string, Tool>;

  async chat(message: string, options: ChatOptions): Promise<ChatResponse> {
    const result = await generateText({
      model: this.model,
      messages: [{ role: "user", content: message }],
      tools: Array.from(this.tools.values()),
      maxSteps: 5, // æœ€å¤šæ‰§è¡Œ 5 æ­¥å·¥å…·è°ƒç”¨
    });

    return {
      text: result.text,
      toolCalls: result.toolCalls,
      usage: result.usage,
    };
  }

  async chatStream(message: string): AsyncIterableIterator<ChatChunk> {
    const stream = await streamText({
      model: this.model,
      messages: [{ role: "user", content: message }],
      tools: Array.from(this.tools.values()),
    });

    for await (const chunk of stream) {
      yield chunk;
    }
  }
}
```

---

### 2.2 å·¥å…·æ³¨å†Œè¡¨ (`src/main/services/ai/tool-registry.ts`)

**èŒè´£ï¼š**

- æ³¨å†Œæ‰€æœ‰å¯ç”¨çš„å·¥å…·
- ç»´æŠ¤å·¥å…·çš„å®šä¹‰ã€å‚æ•° Schemaã€æ‰§è¡Œå‡½æ•°
- æä¾›å·¥å…·æŸ¥è¯¢æ¥å£

**å·¥å…·å®šä¹‰æ ‡å‡†ï¼š**

```typescript
import { z } from "zod";
import { tool } from "ai";

export const searchByKeywordTool = tool({
  description:
    "æ ¹æ®å…³é”®è¯æœç´¢ GitHub Star é¡¹ç›®ï¼Œæ”¯æŒåœ¨é¡¹ç›®åç§°ã€æè¿°ã€README ä¸­æœç´¢",
  parameters: z.object({
    keyword: z.string().describe("æœç´¢å…³é”®è¯"),
    searchIn: z
      .array(z.enum(["name", "description", "readme"]))
      .default(["name", "description"])
      .describe("æœç´¢èŒƒå›´"),
    limit: z.number().default(10).describe("è¿”å›ç»“æœæ•°é‡"),
  }),
  execute: async ({ keyword, searchIn, limit }) => {
    // è°ƒç”¨æ•°æ®åº“æœåŠ¡è¿›è¡Œæœç´¢
    return await databaseService.searchRepositories({
      keyword,
      searchIn,
      limit,
    });
  },
});

export class ToolRegistry {
  private tools = new Map<string, Tool>();

  register(name: string, tool: Tool) {
    this.tools.set(name, tool);
  }

  getAll(): Tool[] {
    return Array.from(this.tools.values());
  }
}
```

---

### 2.3 æœç´¢å·¥å…·é›† (`src/main/services/tools/search-tools.ts`)

#### å·¥å…· 1: `searchByKeyword` - å…³é”®è¯æœç´¢

**åŠŸèƒ½ï¼š** åœ¨é¡¹ç›®åç§°ã€æè¿°ã€README ä¸­æœç´¢å…³é”®è¯

**å‚æ•°ï¼š**

- `keyword`: string - æœç´¢å…³é”®è¯
- `searchIn`: Array<'name' | 'description' | 'readme'> - æœç´¢èŒƒå›´
- `limit`: number - è¿”å›ç»“æœæ•°é‡ï¼ˆé»˜è®¤ 10ï¼‰

**å®ç°ï¼š**

```typescript
// ç®€å•çš„å…¨æ–‡åŒ¹é…ï¼Œæ— éœ€å‘é‡åŒ–
repositories.filter((repo) => {
  if (
    searchIn.includes("name") &&
    repo.name.toLowerCase().includes(keyword.toLowerCase())
  ) {
    return true;
  }
  if (
    searchIn.includes("description") &&
    repo.description?.toLowerCase().includes(keyword.toLowerCase())
  ) {
    return true;
  }
  if (
    searchIn.includes("readme") &&
    repo.readme?.toLowerCase().includes(keyword.toLowerCase())
  ) {
    return true;
  }
  return false;
});
```

---

#### å·¥å…· 2: `filterByLanguage` - è¯­è¨€ç­›é€‰

**åŠŸèƒ½ï¼š** æŒ‰ç¼–ç¨‹è¯­è¨€ç­›é€‰é¡¹ç›®

**å‚æ•°ï¼š**

- `languages`: Array<string> - ç¼–ç¨‹è¯­è¨€åˆ—è¡¨ï¼ˆå¦‚ ['TypeScript', 'Python']ï¼‰

**å®ç°ï¼š**

```typescript
repositories.filter((repo) => languages.includes(repo.language));
```

---

#### å·¥å…· 3: `filterByStars` - Star æ•°ç­›é€‰

**åŠŸèƒ½ï¼š** æŒ‰ Star æ•°èŒƒå›´ç­›é€‰

**å‚æ•°ï¼š**

- `min`: number - æœ€å° Star æ•°
- `max`: number - æœ€å¤§ Star æ•°ï¼ˆå¯é€‰ï¼‰

**å®ç°ï¼š**

```typescript
repositories.filter((repo) => {
  const stars = repo.stargazersCount;
  return stars >= min && (max === undefined || stars <= max);
});
```

---

#### å·¥å…· 4: `filterByDate` - æ—¥æœŸç­›é€‰

**åŠŸèƒ½ï¼š** æŒ‰æœ€åæ›´æ–°æ—¶é—´ç­›é€‰

**å‚æ•°ï¼š**

- `startDate`: Date - å¼€å§‹æ—¥æœŸ
- `endDate`: Date - ç»“æŸæ—¥æœŸ

**å®ç°ï¼š**

```typescript
repositories.filter((repo) => {
  const updated = new Date(repo.updatedAt);
  return updated >= startDate && updated <= endDate;
});
```

---

#### å·¥å…· 5: `searchByTopic` - ä¸»é¢˜æœç´¢

**åŠŸèƒ½ï¼š** æŒ‰ GitHub Topics ç­›é€‰

**å‚æ•°ï¼š**

- `topics`: Array<string> - ä¸»é¢˜åˆ—è¡¨

**å®ç°ï¼š**

```typescript
repositories.filter((repo) =>
  topics.some((topic) => repo.topics?.includes(topic)),
);
```

---

### 2.4 åˆ†æå·¥å…·é›† (`src/main/services/tools/analysis-tools.ts`)

#### å·¥å…· 6: `analyzeLanguageDistribution` - è¯­è¨€åˆ†å¸ƒç»Ÿè®¡

**åŠŸèƒ½ï¼š** ç»Ÿè®¡ Star é¡¹ç›®çš„è¯­è¨€åˆ†å¸ƒ

**è¿”å›ï¼š**

```typescript
{
  "TypeScript": { count: 50, percentage: 40 },
  "Python": { count: 30, percentage: 24 },
  "JavaScript": { count: 20, percentage: 16 }
  // ...
}
```

---

#### å·¥å…· 7: `findTrendingRepos` - çƒ­é—¨é¡¹ç›®å‘ç°

**åŠŸèƒ½ï¼š** æ ¹æ® Star å¢é•¿é€Ÿåº¦å‘ç°çƒ­é—¨é¡¹ç›®

**å‚æ•°ï¼š**

- `days`: number - ç»Ÿè®¡æœ€è¿‘ N å¤©çš„ Star å¢é•¿ï¼ˆé»˜è®¤ 30ï¼‰
- `limit`: number - è¿”å›æ•°é‡ï¼ˆé»˜è®¤ 10ï¼‰

---

#### å·¥å…· 8: `compareRepos` - é¡¹ç›®å¯¹æ¯”

**åŠŸèƒ½ï¼š** å¯¹æ¯”å¤šä¸ªé¡¹ç›®çš„å…³é”®æŒ‡æ ‡

**å‚æ•°ï¼š**

- `repoIds`: Array<string> - é¡¹ç›® ID åˆ—è¡¨

**è¿”å›ï¼š**

```typescript
[
  {
    name: "vite",
    stars: 68000,
    forks: 6200,
    issues: 350,
    lastUpdate: "2025-01-07",
  },
  // ...
];
```

---

### 2.5 GitHub å·¥å…·é›† (`src/main/services/tools/github-tools.ts`)

#### å·¥å…· 9: `getRepoDetails` - è·å–é¡¹ç›®è¯¦æƒ…

**åŠŸèƒ½ï¼š** ä» GitHub API è·å–é¡¹ç›®æœ€æ–°è¯¦æƒ…

**å‚æ•°ï¼š**

- `owner`: string - ä»“åº“æ‰€æœ‰è€…
- `repo`: string - ä»“åº“åç§°

---

#### å·¥å…· 10: `starRepo` / `unstarRepo` - Star æ“ä½œ

**åŠŸèƒ½ï¼š** Star æˆ– Unstar ä¸€ä¸ªé¡¹ç›®

---

#### å·¥å…· 11: `syncStars` - åŒæ­¥ Star æ•°æ®

**åŠŸèƒ½ï¼š** ä» GitHub åŒæ­¥æœ€æ–°çš„ Star åˆ—è¡¨

---

## 3. æ•°æ®å­˜å‚¨è®¾è®¡

### 3.1 æœ¬åœ°æ•°æ®åº“ Schema

**ä½¿ç”¨ JSON æˆ– SQLiteï¼ˆç”¨æˆ·å¯é…ç½®ï¼‰**

#### Repository è¡¨

```typescript
interface Repository {
  id: number;
  nodeId: string;
  name: string;
  fullName: string;
  owner: {
    login: string;
    avatarUrl: string;
  };
  description: string | null;
  language: string | null;
  stargazersCount: number;
  forksCount: number;
  openIssuesCount: number;
  topics: string[];
  createdAt: string;
  updatedAt: string;
  pushedAt: string;
  homepage: string | null;
  readme: string | null; // å­˜å‚¨ README å†…å®¹ç”¨äºå…¨æ–‡æœç´¢
  starredAt: string; // ç”¨æˆ· Star çš„æ—¶é—´

  // æœ¬åœ°å…ƒæ•°æ®
  tags?: string[]; // ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾
  notes?: string; // ç”¨æˆ·ç¬”è®°
  lastSyncedAt: string; // æœ€ååŒæ­¥æ—¶é—´
}
```

#### User è¡¨

```typescript
interface User {
  id: number;
  login: string;
  name: string;
  email: string | null;
  avatarUrl: string;
  totalStars: number;
  lastSyncedAt: string;
}
```

---

### 3.2 æ•°æ®åŒæ­¥ç­–ç•¥

1. **é¦–æ¬¡åŒæ­¥**ï¼š
   - è·å–æ‰€æœ‰ Star é¡¹ç›®åˆ—è¡¨
   - æ‰¹é‡è·å–é¡¹ç›®è¯¦æƒ…ï¼ˆåŒ…æ‹¬ READMEï¼‰
   - å­˜å‚¨åˆ°æœ¬åœ°æ•°æ®åº“

2. **å¢é‡åŒæ­¥**ï¼š
   - æ£€æŸ¥ `starredAt` æ—¶é—´æˆ³
   - åªåŒæ­¥æ–°å¢çš„ Star é¡¹ç›®
   - æ›´æ–°å·²æœ‰é¡¹ç›®çš„ Star æ•°ã€Issue æ•°ç­‰åŠ¨æ€æ•°æ®

3. **åå°åŒæ­¥**ï¼š
   - åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŒæ­¥
   - ç”¨æˆ·å¯æ‰‹åŠ¨è§¦å‘åŒæ­¥
   - å®šæ—¶åŒæ­¥ï¼ˆå¯é…ç½®ï¼Œå¦‚æ¯å°æ—¶ï¼‰

---

## 4. AI Agent å¯¹è¯æµç¨‹ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç®€å•å…³é”®è¯æœç´¢

**ç”¨æˆ·è¾“å…¥ï¼š**

> å¸®æˆ‘æ‰¾æ‰¾å…³äº React çš„é¡¹ç›®

**AI Agent å¤„ç†æµç¨‹ï¼š**

1. **æ„å›¾ç†è§£**ï¼šç”¨æˆ·æƒ³æœç´¢åŒ…å« "React" å…³é”®è¯çš„é¡¹ç›®

2. **å·¥å…·è°ƒç”¨**ï¼š

   ```json
   {
     "tool": "searchByKeyword",
     "parameters": {
       "keyword": "React",
       "searchIn": ["name", "description"],
       "limit": 10
     }
   }
   ```

3. **ç»“æœæ•´åˆ**ï¼š

   ```
   æ‰¾åˆ°äº† 10 ä¸ªå…³äº React çš„é¡¹ç›®ï¼š

   1. facebook/react - ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“
   2. vercel/next.js - React æ¡†æ¶ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒ
   3. remix-run/remix - å…¨æ ˆ Web æ¡†æ¶
   ...
   ```

---

### ç¤ºä¾‹ 2: å¤åˆæ¡ä»¶ç­›é€‰

**ç”¨æˆ·è¾“å…¥ï¼š**

> æ‰¾ä¸€äº› TypeScript å†™çš„ã€Star æ•°è¶…è¿‡ 1 ä¸‡çš„é¡¹ç›®ï¼Œæœ€è¿‘åŠå¹´æœ‰æ›´æ–°çš„

**AI Agent å¤„ç†æµç¨‹ï¼š**

1. **æ„å›¾ç†è§£**ï¼šéœ€è¦ç»„åˆå¤šä¸ªç­›é€‰æ¡ä»¶

2. **å·¥å…·è°ƒç”¨åºåˆ—**ï¼š

   ```json
   [
     {
       "tool": "filterByLanguage",
       "parameters": { "languages": ["TypeScript"] }
     },
     {
       "tool": "filterByStars",
       "parameters": { "min": 10000 }
     },
     {
       "tool": "filterByDate",
       "parameters": {
         "startDate": "2024-07-07",
         "endDate": "2025-01-07"
       }
     }
   ]
   ```

3. **ç»“æœæ•´åˆ**ï¼š

   ```
   æ‰¾åˆ°äº† 15 ä¸ªç¬¦åˆæ¡ä»¶çš„é¡¹ç›®ï¼š

   1. microsoft/vscode (Stars: 168k) - æœ€åæ›´æ–°: 2025-01-06
   2. vitejs/vite (Stars: 68k) - æœ€åæ›´æ–°: 2025-01-05
   ...
   ```

---

### ç¤ºä¾‹ 3: åˆ†æç±»æŸ¥è¯¢

**ç”¨æˆ·è¾“å…¥ï¼š**

> åˆ†æä¸€ä¸‹æˆ‘ Star çš„é¡¹ç›®éƒ½æ˜¯å“ªäº›è¯­è¨€çš„

**AI Agent å¤„ç†æµç¨‹ï¼š**

1. **æ„å›¾ç†è§£**ï¼šéœ€è¦ç»Ÿè®¡è¯­è¨€åˆ†å¸ƒ

2. **å·¥å…·è°ƒç”¨**ï¼š

   ```json
   {
     "tool": "analyzeLanguageDistribution",
     "parameters": {}
   }
   ```

3. **ç»“æœæ•´åˆ**ï¼š

   ```
   ä½  Star çš„é¡¹ç›®è¯­è¨€åˆ†å¸ƒå¦‚ä¸‹ï¼š

   1. TypeScript: 50 ä¸ªé¡¹ç›® (40%)
   2. Python: 30 ä¸ªé¡¹ç›® (24%)
   3. JavaScript: 20 ä¸ªé¡¹ç›® (16%)
   4. Go: 15 ä¸ªé¡¹ç›® (12%)
   5. å…¶ä»–: 10 ä¸ªé¡¹ç›® (8%)

   çœ‹æ¥ä½ å¯¹å‰ç«¯æŠ€æœ¯æ ˆç‰¹åˆ«æ„Ÿå…´è¶£ï¼
   ```

---

## 5. å·¥å…·è°ƒç”¨å¯è§†åŒ–

åœ¨èŠå¤©ç•Œé¢ä¸­ï¼Œå±•ç¤º AI Agent çš„å·¥å…·è°ƒç”¨è¿‡ç¨‹ï¼Œå¢å¼ºé€æ˜åº¦å’Œå¯è§£é‡Šæ€§ã€‚

**UI è®¾è®¡ç¤ºä¾‹ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ ä½ ï¼šæ‰¾ä¸€äº› TypeScript å†™çš„é¡¹ç›®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AIï¼šæ­£åœ¨ä¸ºä½ æœç´¢...                        â”‚
â”‚                                               â”‚
â”‚ ğŸ”§ ä½¿ç”¨å·¥å…·ï¼šfilterByLanguage                â”‚
â”‚    â”œâ”€ å‚æ•°ï¼šlanguages: ["TypeScript"]        â”‚
â”‚    â””â”€ ç»“æœï¼šæ‰¾åˆ° 50 ä¸ªé¡¹ç›®                    â”‚
â”‚                                               â”‚
â”‚ æ‰¾åˆ°äº† 50 ä¸ª TypeScript é¡¹ç›®ï¼Œä»¥ä¸‹æ˜¯å‰ 10 ä¸ªï¼š â”‚
â”‚                                               â”‚
â”‚ 1. microsoft/vscode                           â”‚
â”‚    Stars: 168k | TypeScript                  â”‚
â”‚    Visual Studio Code - ä»£ç ç¼–è¾‘å™¨            â”‚
â”‚                                               â”‚
â”‚ 2. vitejs/vite                                â”‚
â”‚    Stars: 68k | TypeScript                   â”‚
â”‚    ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·                          â”‚
â”‚ ...                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 6.1 æœ¬åœ°æ•°æ®ç´¢å¼•

è™½ç„¶ä¸ä½¿ç”¨å‘é‡æ•°æ®åº“ï¼Œä½†ä»éœ€è¦ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼š

- **SQLite ç´¢å¼•**ï¼ˆå¦‚æœä½¿ç”¨ SQLiteï¼‰ï¼š

  ```sql
  CREATE INDEX idx_language ON repositories(language);
  CREATE INDEX idx_stars ON repositories(stargazersCount);
  CREATE INDEX idx_updated ON repositories(updatedAt);
  CREATE INDEX idx_name ON repositories(name);
  ```

- **å…¨æ–‡æœç´¢ç´¢å¼•**ï¼ˆSQLite FTS5ï¼‰ï¼š
  ```sql
  CREATE VIRTUAL TABLE repositories_fts USING fts5(
    name, description, readme
  );
  ```

### 6.2 å·¥å…·è°ƒç”¨ä¼˜åŒ–

- **å¹¶è¡Œå·¥å…·è°ƒç”¨**ï¼šå¦‚æœå¤šä¸ªå·¥å…·è°ƒç”¨ä¹‹é—´æ— ä¾èµ–å…³ç³»ï¼Œå¹¶è¡Œæ‰§è¡Œ
- **ç»“æœç¼“å­˜**ï¼šå¯¹äºçŸ­æ—¶é—´å†…ç›¸åŒçš„æŸ¥è¯¢ï¼Œä½¿ç”¨ç¼“å­˜ç»“æœ
- **æ¸è¿›å¼è¿”å›**ï¼šä½¿ç”¨æµå¼å“åº”ï¼Œé€æ­¥è¿”å›ç»“æœè€Œéç­‰å¾…æ‰€æœ‰å·¥å…·æ‰§è¡Œå®Œæ¯•

### 6.3 æ•°æ®åŒæ­¥ä¼˜åŒ–

- **å¢é‡åŒæ­¥**ï¼šåªåŒæ­¥å˜åŒ–çš„æ•°æ®
- **æ‰¹é‡è¯·æ±‚**ï¼šä½¿ç”¨ GitHub GraphQL API æ‰¹é‡è·å–æ•°æ®
- **Rate Limiting**ï¼šæ™ºèƒ½æ§åˆ¶ API è¯·æ±‚é¢‘ç‡

---

## 7. å¯æ‰©å±•æ€§è®¾è®¡

### 7.1 è‡ªå®šä¹‰å·¥å…·æ‰©å±•

ç”¨æˆ·å¯ä»¥ç¼–å†™è‡ªå®šä¹‰å·¥å…·å¹¶æ³¨å†Œåˆ°ç³»ç»Ÿä¸­ï¼š

```typescript
// ç”¨æˆ·è‡ªå®šä¹‰å·¥å…·ç¤ºä¾‹
export const myCustomTool = tool({
  description: "æˆ‘çš„è‡ªå®šä¹‰æœç´¢é€»è¾‘",
  parameters: z.object({
    // è‡ªå®šä¹‰å‚æ•°
  }),
  execute: async (params) => {
    // è‡ªå®šä¹‰é€»è¾‘
  },
});

// æ³¨å†Œåˆ°ç³»ç»Ÿ
toolRegistry.register("myCustomTool", myCustomTool);
```

### 7.2 å¤š AI Provider æ”¯æŒ

é€šè¿‡ AI SDK V5 ç»Ÿä¸€æ¥å£ï¼Œæ”¯æŒå¤šç§ AI Providerï¼š

- OpenAI (GPT-4, GPT-4 Turbo)
- Anthropic (Claude 3.5 Sonnet)
- Google (Gemini)
- æœ¬åœ°æ¨¡å‹ï¼ˆé€šè¿‡ Ollamaï¼‰

### 7.3 æ’ä»¶ç³»ç»Ÿï¼ˆæœªæ¥æ‰©å±•ï¼‰

- ç¤¾åŒºå¯ä»¥å¼€å‘ç¬¬ä¸‰æ–¹å·¥å…·æ’ä»¶
- é€šè¿‡æ’ä»¶å¸‚åœºåˆ†å‘å’Œå®‰è£…
- æ ‡å‡†åŒ–çš„æ’ä»¶æ¥å£

---

## 8. ä¼˜åŠ¿æ€»ç»“

ç›¸æ¯”ä¼ ç»Ÿå‘é‡æœç´¢æ–¹æ¡ˆï¼ŒAgentic AI å·¥å…·ç³»ç»Ÿçš„ä¼˜åŠ¿ï¼š

| ç»´åº¦         | å‘é‡æœç´¢æ–¹æ¡ˆ          | Agentic AI å·¥å…·æ–¹æ¡ˆ   |
| ------------ | --------------------- | --------------------- |
| **è®¡ç®—æˆæœ¬** | é«˜ï¼ˆç”Ÿæˆ Embeddingsï¼‰ | ä½ï¼ˆç®€å•æ–‡æœ¬åŒ¹é…ï¼‰    |
| **å­˜å‚¨éœ€æ±‚** | å¤§ï¼ˆå‘é‡æ•°æ®åº“ï¼‰      | å°ï¼ˆJSON/SQLiteï¼‰     |
| **å¯è§£é‡Šæ€§** | é»‘ç›’ï¼ˆå‘é‡ç›¸ä¼¼åº¦ï¼‰    | é€æ˜ï¼ˆå·¥å…·è°ƒç”¨é“¾ï¼‰    |
| **ç²¾ç¡®æ§åˆ¶** | å¼±ï¼ˆä¾èµ–å‘é‡è´¨é‡ï¼‰    | å¼ºï¼ˆç²¾ç¡®çš„ç­›é€‰æ¡ä»¶ï¼‰  |
| **çµæ´»æ€§**   | ä½ï¼ˆå›ºå®šæœç´¢é€»è¾‘ï¼‰    | é«˜ï¼ˆAI è‡ªä¸»ç»„åˆå·¥å…·ï¼‰ |
| **æ‰©å±•æ€§**   | ä¸­ï¼ˆéœ€é‡æ–°è®­ç»ƒï¼‰      | é«˜ï¼ˆæ³¨å†Œæ–°å·¥å…·å³å¯ï¼‰  |
| **å“åº”é€Ÿåº¦** | æ…¢ï¼ˆå‘é‡è®¡ç®—ï¼‰        | å¿«ï¼ˆç´¢å¼•æŸ¥è¯¢ï¼‰        |

---

## 9. å®ç°è·¯çº¿å›¾

### Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½ âœ…

- [x] AI Settings æ¶æ„é‡æ„
- [x] Provider Account ç®¡ç†
- [x] æµ‹è¯•åŸºç¡€è®¾æ–½å»ºç«‹

### Phase 2: æ•°æ®å±‚å®ç° ğŸš§

- [ ] æœ¬åœ°æ•°æ®åº“è®¾è®¡å’Œå®ç°ï¼ˆJSON/SQLiteï¼‰
- [ ] GitHub API é›†æˆå’Œæ•°æ®åŒæ­¥
- [ ] å®‰å…¨å­˜å‚¨ï¼ˆToken ç®¡ç†ï¼‰
- [ ] å¢é‡åŒæ­¥æœºåˆ¶

### Phase 3: AI Agent æ ¸å¿ƒ ğŸš§

- [ ] AI SDK V5 é›†æˆ
- [ ] Tool Registry å®ç°
- [ ] å·¥å…·è°ƒç”¨ç³»ç»Ÿ
- [ ] å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†

### Phase 4: æœç´¢å·¥å…·é›† ğŸš§

- [ ] `searchByKeyword` å®ç°
- [ ] `filterByLanguage` å®ç°
- [ ] `filterByStars` å®ç°
- [ ] `filterByDate` å®ç°
- [ ] `searchByTopic` å®ç°
- [ ] `searchInReadme` å®ç°

### Phase 5: åˆ†æå·¥å…·é›† ğŸš§

- [ ] `analyzeLanguageDistribution` å®ç°
- [ ] `findTrendingRepos` å®ç°
- [ ] `compareRepos` å®ç°

### Phase 6: UI å®Œå–„ ğŸš§

- [ ] èŠå¤©ç•Œé¢å®ç°
- [ ] æµå¼å“åº”å±•ç¤º
- [ ] å·¥å…·è°ƒç”¨å¯è§†åŒ–
- [ ] æœç´¢ç»“æœå±•ç¤ºä¼˜åŒ–

### Phase 7: é«˜çº§åŠŸèƒ½ â³

- [ ] ç”¨æˆ·æ ‡ç­¾å’Œç¬”è®°ç³»ç»Ÿ
- [ ] æ•°æ®å¯¼å‡ºå’Œå¤‡ä»½
- [ ] è‡ªå®šä¹‰å·¥å…·æ‰©å±•æ¥å£
- [ ] å¤šè´¦æˆ·æ”¯æŒ

---

## 10. æŠ€æœ¯é€‰å‹ç†ç”±

### ä¸ºä»€ä¹ˆé€‰æ‹© AI SDK V5ï¼Ÿ

- âœ… ç»Ÿä¸€çš„ AI Provider æ¥å£
- âœ… åŸç”Ÿæ”¯æŒ Tool Calling
- âœ… æµå¼å“åº”
- âœ… TypeScript ç±»å‹å®‰å…¨
- âœ… æ´»è·ƒçš„ç¤¾åŒºå’Œæ–‡æ¡£

### ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å‘é‡æ•°æ®åº“ï¼Ÿ

- âŒ GitHub Star é¡¹ç›®æ•°é‡æœ‰é™ï¼ˆé€šå¸¸ < 10kï¼‰
- âŒ ä¼ ç»Ÿç´¢å¼•æŸ¥è¯¢æ€§èƒ½è¶³å¤Ÿï¼ˆSQLite FTS5ï¼‰
- âŒ å‘é‡æœç´¢å¢åŠ å¤æ‚åº¦å’Œæˆæœ¬
- âœ… å·¥å…·é©±åŠ¨çš„æœç´¢æ›´ç²¾ç¡®ã€å¯æ§ã€å¯è§£é‡Š

### ä¸ºä»€ä¹ˆä½¿ç”¨ JSON/SQLiteï¼Ÿ

- âœ… è½»é‡çº§ï¼Œæ— éœ€é¢å¤–ä¾èµ–
- âœ… è·¨å¹³å°å…¼å®¹æ€§å¥½
- âœ… æ”¯æŒå…¨æ–‡æœç´¢ï¼ˆSQLite FTS5ï¼‰
- âœ… æ˜“äºå¤‡ä»½å’Œè¿ç§»

---

## é™„å½•ï¼šå·¥å…·å®šä¹‰å®Œæ•´ç¤ºä¾‹

```typescript
// src/main/services/tools/search-tools.ts
import { z } from "zod";
import { tool } from "ai";
import { databaseService } from "../database";

export const searchTools = {
  searchByKeyword: tool({
    description:
      "æ ¹æ®å…³é”®è¯æœç´¢ GitHub Star é¡¹ç›®ï¼Œæ”¯æŒåœ¨é¡¹ç›®åç§°ã€æè¿°ã€README ä¸­æœç´¢",
    parameters: z.object({
      keyword: z.string().describe("æœç´¢å…³é”®è¯"),
      searchIn: z
        .array(z.enum(["name", "description", "readme"]))
        .default(["name", "description"])
        .describe(
          "æœç´¢èŒƒå›´ï¼šnameï¼ˆé¡¹ç›®åï¼‰ã€descriptionï¼ˆæè¿°ï¼‰ã€readmeï¼ˆREADMEå†…å®¹ï¼‰",
        ),
      limit: z
        .number()
        .min(1)
        .max(100)
        .default(10)
        .describe("è¿”å›ç»“æœæ•°é‡ï¼Œé»˜è®¤10ï¼Œæœ€å¤§100"),
    }),
    execute: async ({ keyword, searchIn, limit }) => {
      const results = await databaseService.searchRepositories({
        keyword,
        fields: searchIn,
        limit,
      });

      return {
        count: results.length,
        repositories: results.map((repo) => ({
          name: repo.fullName,
          description: repo.description,
          language: repo.language,
          stars: repo.stargazersCount,
          url: `https://github.com/${repo.fullName}`,
        })),
      };
    },
  }),

  filterByLanguage: tool({
    description: "æŒ‰ç¼–ç¨‹è¯­è¨€ç­›é€‰ GitHub Star é¡¹ç›®",
    parameters: z.object({
      languages: z
        .array(z.string())
        .describe('ç¼–ç¨‹è¯­è¨€åˆ—è¡¨ï¼Œå¦‚ ["TypeScript", "Python"]'),
      limit: z.number().min(1).max(100).default(10).describe("è¿”å›ç»“æœæ•°é‡"),
    }),
    execute: async ({ languages, limit }) => {
      const results = await databaseService.filterByLanguage(languages, limit);

      return {
        count: results.length,
        repositories: results.map((repo) => ({
          name: repo.fullName,
          language: repo.language,
          stars: repo.stargazersCount,
        })),
      };
    },
  }),

  // ... å…¶ä»–å·¥å…·å®šä¹‰
};
```

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-01-07  
**ä½œè€…ï¼š** Starepo Team
